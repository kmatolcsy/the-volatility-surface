(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{176:function(t,e){},178:function(t,e,n){},179:function(t,e,n){"use strict";n.r(e);var a=n(6),r=n.n(a),i=n(84),c=n.n(i),s=n(3),o=n(8),u=n(183),h=n(12),l=n(22),f=n(23),p=function(){function t(e){Object(l.a)(this,t),this.coordinates=e,this.x=e[0],this.y=e[1],this.z=e[2],this.w=1}return Object(f.a)(t,[{key:"_rotateX",value:function(t){var e=this.y,n=this.z;this.y=Object(u.a)(t)*e+Object(u.d)(t)*n,this.z=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"_rotateY",value:function(t){var e=this.x,n=this.z;this.x=Object(u.a)(t)*e-Object(u.d)(t)*n,this.z=Object(u.a)(t)*n+Object(u.d)(t)*e}},{key:"_rotateZ",value:function(t){var e=this.x,n=this.y;this.x=Object(u.a)(t)*e+Object(u.d)(t)*n,this.y=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"scale",value:function(t){return this.x*=t[0],this.y*=t[1],this.z*=t[2],this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.translate(e.map((function(t){return-t}))),this._rotateZ(t.alpha),this._rotateY(t.beta),this._rotateX(t.gamma),this.translate(e),this}},{key:"translate",value:function(t){return this.x+=t[0],this.y+=t[1],this.z+=t[2],this}},{key:"perspective",value:function(t,e,n){var a=this.x,r=this.y,i=this.z,c=Object(u.e)((Math.PI-t)/2),s=(e+n)/(2*e*n),o=2*e*n/(e-n);return this.x=c*a/(o*r),this.y=s-1/(o*r),this.z=c*i/(o*r),this}},{key:"centroid",get:function(){return{x:this.x,y:this.y,z:this.z}}}]),t}(),b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();Object(l.a)(this,t),this.points=e.map((function(t){return new p(t)})),this.generator=n}return Object(f.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.points=this.points.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.points=this.points.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.points=this.points.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.points.map((function(t){return t.x}))),y:Object(u.b)(this.points.map((function(t){return t.y}))),z:Object(u.b)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=[].concat(Object(h.a)(this.points),[this.points[0]]),e=0,n=0;n<t.length-1;n++){var a=t[n],r=t[n+1];e+=(r.x-a.x)*(r.z+a.z)}return e}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.b)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),j=n(1),d=function(t){var e=t.trf,n=t.angles,a=n.alpha>Math.PI?-1:1,r=n.alpha>1.5*Math.PI||n.alpha<.5*Math.PI?-1:1,i=n.gamma>Math.PI?1:-1;return[e(new b([[a,1,1],[a,1,-1],[a,-1,-1],[a,-1,1]])),e(new b([[1,r,1],[1,r,-1],[-1,r,-1],[-1,r,1]])),e(new b([[1,1,i],[1,-1,i],[-1,-1,i],[-1,1,i]]))].map((function(t){return Object(j.jsx)("path",{d:t.data,className:"base"})}))},m=n(4),y=n(182),O=n(15),v=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},x=function(t){var e=Object(O.a)().domain(Object(y.a)(t.columns)).range([-1,1]),n=Object(O.a)().domain(Object(y.a)(t.values.flat())).range([1,-1]).nice(),a=Object(O.a)().domain(Object(y.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return a(t)})),scale:n,labels:t}},g=function(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=a?n-1:n,i=(e-t)/r;return Array.from({length:n},(function(e,n){return t+i*n}))},k=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},w=function(t){var e,n=t.df,a=t.trf,r=t.angles,i=r.alpha<Math.PI?-1:1,c=r.alpha<1.5*Math.PI&&r.alpha>.5*Math.PI?-1:1,o=r.gamma>Math.PI?1:-1,u=1.23,l=[],f=Object(m.a)(n.index.entries());try{for(f.s();!(e=f.n()).done;){var d=Object(s.a)(e.value,2),y=d[0],O=d[1];y%2||l.push({labelText:n.labels.index[y].toFixed(2),labelPosition:a(new p([i*u,O,o*u])),line:a(new b([[-i,O,-o],[-i,O,o],[i,O,o]]))})}}catch(T){f.e(T)}finally{f.f()}var v,x=Object(m.a)(n.columns.entries());try{for(x.s();!(v=x.n()).done;){var k=Object(s.a)(v.value,2),w=k[0],P=k[1];w%2||l.push({labelText:n.labels.columns[w].toFixed(2),labelPosition:a(new p([P,c*u,o*u])),line:a(new b([[P,-c,-o],[P,-c,o],[P,c,o]]))})}}catch(T){x.e(T)}finally{x.f()}var z,I=g.apply(void 0,Object(h.a)(n.scale.domain()).concat([5])),M=Object(m.a)(I.map((function(t){return n.scale(t)})).entries());try{for(M.s();!(z=M.n()).done;){var _=Object(s.a)(z.value,2),E=_[0],N=_[1];l.push({labelText:I[E].toFixed(2),labelPosition:a(new p([-c*u,i*u,N])),line:a(new b([[i,-c,N],[-i,-c,N],[-i,c,N]]))})}}catch(T){M.e(T)}finally{M.f()}return l.map((function(t){var e=t.labelText,n=t.labelPosition,a=t.line;return Object(j.jsxs)("g",{children:[Object(j.jsx)("path",{d:a.data,className:"grid"}),Object(j.jsx)("text",{x:n.x-12,y:n.z+2,children:e,className:"label"})]})}))},P=function(){function t(e){Object(l.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},a=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},r=0;r<e.index.length-1;r++)for(var i=0;i<e.columns.length-1;i++)this.polygons.push(new b(a(r,i)))}return Object(f.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.polygons=this.polygons.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.polygons=this.polygons.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.polygons=this.polygons.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.b)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.b)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(k)}}]),t}(),z=function(t){var e=t.df,n=t.trf,r=t.colors,i=n(new P(e));return Object(a.useEffect)((function(){return Object(o.h)(".marks").data(i.paths)})),i.paths.map((function(t,e){return Object(j.jsx)("path",{className:"three marks",d:t.data,fill:r(t)},e)}))},I={alpha:7*Math.PI/4,beta:0,gamma:7*Math.PI/4},M=function(t){var e=t.df,n=t.width,r=t.height,i=Object(a.useState)(I),c=Object(s.a)(i,2),h=c[0],l=c[1],f=Object(a.useRef)({x:0,y:0}),p=function(t){f.current={x:t.x,y:t.y}},b=function(t){return l({alpha:Object(u.c)(h.alpha+(t.x-f.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.c)(h.gamma-(t.y-f.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(o.c)().on("start",p).on("drag",b);Object(o.g)("svg").call(t),Object(o.h)(".three").sort(k)}));var m=function(t){return t.rotate(h).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500])};return Object(j.jsxs)("svg",{width:n,height:r,children:[Object(j.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(j.jsx)(d,{df:e,trf:m,angles:h}),Object(j.jsx)(w,{df:e,trf:m,angles:h}),Object(j.jsx)(z,{df:e,trf:m,colors:function(t){var e=Object(o.f)(o.d).domain([1,-1])(t.colorValue);return t.area<0?e:Object(o.a)(e).darker()}})]}),Object(j.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(j.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(j.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},_=(n(178),function(){var t=Object(a.useState)(null),e=Object(s.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(v).then(x).then(r)}),[]),n?Object(j.jsx)("div",{children:Object(j.jsx)(M,{df:n,width:900,height:600})}):"Loading..."});c.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(_,{})}),document.getElementById("root"))}},[[179,1,2]]]);
//# sourceMappingURL=main.6d381791.chunk.js.map