(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{178:function(t,e){},180:function(t,e,n){"use strict";n.r(e);var r=n(5),c=n.n(r),a=n(86),o=n.n(a),i=n(2),s=n(4),u=n(184),h=n(183),f=n(14),b=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},l=function(t){var e=Object(f.a)().domain(Object(h.a)(t.columns)).range([-1,1]),n=Object(f.a)().domain(Object(h.a)(t.values.flat())).range([1,-1]),r=Object(f.a)().domain(Object(h.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return r(t)}))}},j=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},O=n(15),p=n(16),m=n(17),v=function(){function t(e){Object(O.a)(this,t),this.coordinates=e;var n=Object(i.a)(e,3),r=n[0],c=n[1],a=n[2];this.vector=Object(u.c)([[r],[c],[a],[1]])}return Object(p.a)(t,[{key:"apply",value:function(t){return this.vector=Object(u.f)(t,this.vector),this}},{key:"x",get:function(){return this.vector.subset(Object(u.b)(0,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"y",get:function(){return this.vector.subset(Object(u.b)(1,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"z",get:function(){return this.vector.subset(Object(u.b)(2,0))/this.vector.subset(Object(u.b)(3,0))}}]),t}(),d=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(s.e)();Object(O.a)(this,t),this.points=e.map((function(t){return new v(t)})),this.generator=n}return Object(p.a)(t,[{key:"apply",value:function(t){return this.points=this.points.map((function(e){return e.apply(t)})),this}},{key:"centroid",get:function(){return{x:Object(u.d)(this.points.map((function(t){return t.x}))),y:Object(u.d)(this.points.map((function(t){return t.y}))),z:Object(u.d)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=0,e=[].concat(Object(m.a)(this.points),[this.points[0]]),n=0;n<e.length-1;n++){var r=e[n],c=e[n+1];t+=(c.x-r.x)*(c.z+r.z)}return t}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.d)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),y=function(){function t(e){Object(O.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},r=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},c=0;c<e.index.length-1;c++)for(var a=0;a<e.columns.length-1;a++)this.polygons.push(new d(r(c,a)))}return Object(p.a)(t,[{key:"apply",value:function(t){return this.polygons=this.polygons.map((function(e){return e.apply(t)})),this}},{key:"centroid",get:function(){return{x:Object(u.d)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.d)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.d)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(j)}}]),t}(),g=n(1),x=function(t){var e=t.df,n=t.camera,c=t.colorScale,a=new y(e).apply(n.view);return Object(r.useEffect)((function(){return Object(s.h)(".marks").data(a.paths)})),a.paths.map((function(t,e){return Object(g.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(s.a)(c(t.colorValue)).darker():c(t.colorValue)},e)}))},k=(n(18),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];Object(O.a)(this,t),console.log("camera");var n=Object(i.a)(e,3),r=n[0],c=n[1],a=n[2];this.transformations=Object(u.c)([[1,0,0,r],[0,1,0,c],[0,0,1,a],[0,0,0,1]])}return Object(p.a)(t,[{key:"_rotateX",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[1,0,0,0],[0,e,-n,0],[0,n,+e,0],[0,0,0,1]])}},{key:"_rotateY",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[+e,0,n,0],[0,1,0,0],[-n,0,e,0],[0,0,0,1]])}},{key:"_rotateZ",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[e,-n,0,0],[n,+e,0,0],[0,0,1,0],[0,0,0,1]])}},{key:"scale",value:function(t){var e=Object(i.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.c)([[n,0,0,0],[0,r,0,0],[0,0,c,0],[0,0,0,1]]);return this.transformations=Object(u.f)(a,this.transformations),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];this.translate(e.map((function(t){return-t})));var n=[this._rotateX(t.gamma),this._rotateY(t.beta),this._rotateZ(t.alpha)],r=n.reduce((function(t,e){return Object(u.f)(t,e)}));return this.transformations=Object(u.f)(r,this.transformations),this.translate(e),this}},{key:"translate",value:function(t){var e=Object(i.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.c)([[1,0,0,n],[0,1,0,r],[0,0,1,c],[0,0,0,1]]);return this.transformations=Object(u.f)(a,this.transformations),this}},{key:"perspective",value:function(t,e,n){var r=Object(u.h)(.5*(Math.PI-t)),c=2*e*n/(e-n),a=(e+n)/(e-n),o=Object(u.c)([[r,0,0,0],[0,+a,0,c],[0,0,r,0],[0,-1,0,0]]);return this.transformations=Object(u.f)(o,this.transformations),this}},{key:"view",get:function(){return this.transformations}}]),t}()),w={alpha:Math.PI/4,beta:0,gamma:Math.PI/4},I=function(t){var e=t.df,n=t.width,c=t.height,a=Object(r.useState)(w),o=Object(i.a)(a,2),h=o[0],f=o[1],b=Object(r.useRef)({x:0,y:0}),l=function(t){b.current={x:t.x,y:t.y}},O=function(t){return f({alpha:Object(u.e)(h.alpha-(t.x-b.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.e)(h.gamma+(t.y-b.current.y)/300*Math.PI,2*Math.PI)})};Object(r.useEffect)((function(){var t=Object(s.c)().on("start",l).on("drag",O).on("end",(function(t){return console.log("end")}));Object(s.g)("svg").call(t),Object(s.h)(".three").sort(j)}));var p=Object(s.f)(s.d).domain([1,-1]),m=(new k).rotate(h).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([300,300,300]);return Object(g.jsx)("svg",{width:n,height:c,children:Object(g.jsx)("g",{transform:"translate(".concat(n/2,", ").concat(c/2,")"),children:Object(g.jsx)(x,{df:e,camera:m,colorScale:p})})})},M=function(){var t=Object(r.useState)(null),e=Object(i.a)(t,2),n=e[0],c=e[1];return Object(r.useEffect)((function(){return Object(s.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(b).then(l).then(c)}),[]),n?(console.log(n),Object(g.jsx)("div",{children:Object(g.jsx)(I,{df:n,width:900,height:600})})):"Loading..."};o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(M,{})}),document.getElementById("root"))}},[[180,1,2]]]);
//# sourceMappingURL=main.9cc24164.chunk.js.map