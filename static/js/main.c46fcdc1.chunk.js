(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{176:function(t,e){},178:function(t,e,n){"use strict";n.r(e);var a=n(6),r=n.n(a),i=n(84),s=n.n(i),c=n(2),o=n(5),u=n(182),h=n(181),l=n(14),f=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},p=function(t){var e=Object(l.a)().domain(Object(h.a)(t.columns)).range([-1,1]),n=Object(l.a)().domain(Object(h.a)(t.values.flat())).range([1,-1]),a=Object(l.a)().domain(Object(h.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return a(t)})),labels:t}},j=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},b=n(22),d=n(23),y=n(15),O=function(){function t(e){Object(b.a)(this,t),this.coordinates=e,this.x=e[0],this.y=e[1],this.z=e[2],this.w=1}return Object(d.a)(t,[{key:"_rotateX",value:function(t){var e=this.y,n=this.z;this.y=Object(u.a)(t)*e+Object(u.d)(t)*n,this.z=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"_rotateY",value:function(t){var e=this.x,n=this.z;this.x=Object(u.a)(t)*e-Object(u.d)(t)*n,this.z=Object(u.a)(t)*n+Object(u.d)(t)*e}},{key:"_rotateZ",value:function(t){var e=this.x,n=this.y;this.x=Object(u.a)(t)*e+Object(u.d)(t)*n,this.y=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"scale",value:function(t){return this.x*=t[0],this.y*=t[1],this.z*=t[2],this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.translate(e.map((function(t){return-t}))),this._rotateZ(t.alpha),this._rotateY(t.beta),this._rotateX(t.gamma),this.translate(e),this}},{key:"translate",value:function(t){return this.x+=t[0],this.y+=t[1],this.z+=t[2],this}},{key:"perspective",value:function(t,e,n){var a=this.x,r=this.y,i=this.z,s=Object(u.e)((Math.PI-t)/2),c=(e+n)/(2*e*n),o=2*e*n/(e-n);return this.x=s*a/(o*r),this.y=c-1/(o*r),this.z=s*i/(o*r),this}},{key:"centroid",get:function(){return{x:this.x,y:this.y,z:this.z}}}]),t}(),m=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();Object(b.a)(this,t),this.points=e.map((function(t){return new O(t)})),this.generator=n}return Object(d.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.points=this.points.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.points=this.points.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.points=this.points.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.points.map((function(t){return t.x}))),y:Object(u.b)(this.points.map((function(t){return t.y}))),z:Object(u.b)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=[].concat(Object(y.a)(this.points),[this.points[0]]),e=0,n=0;n<t.length-1;n++){var a=t[n],r=t[n+1];e+=(r.x-a.x)*(r.z+a.z)}return e}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.b)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),v=function(){function t(e){Object(b.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},a=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},r=0;r<e.index.length-1;r++)for(var i=0;i<e.columns.length-1;i++)this.polygons.push(new m(a(r,i)))}return Object(d.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.polygons=this.polygons.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.polygons=this.polygons.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.polygons=this.polygons.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.b)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.b)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(j)}}]),t}(),g=n(1),x=function(t){var e=t.df,n=t.angles,r=t.colorScale,i=new v(e).rotate(n).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){return Object(o.h)(".marks").data(i.paths)})),i.paths.map((function(t,e){return Object(g.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(o.a)(r(t.colorValue)).darker():r(t.colorValue)},e)}))},k=n(3),w=function(t){var e,n=t.df,r=t.trf,i=t.angles,s=[],u=i.alpha>Math.PI?-1.075:1.075,h=r(new m([[u,1,1],[u,1,-1],[u,-1,-1],[u,-1,1]])),l=[],f=Object(k.a)(n.index.entries());try{for(f.s();!(e=f.n()).done;){var p=Object(c.a)(e.value,2),j=p[0],b=p[1];j%2||l.push(r(new m([[u,b,1],[u,b,-1]])))}}catch(E){f.e(E)}finally{f.f()}var d,y=i.alpha>1.5*Math.PI||i.alpha<.5*Math.PI?-1.075:1.075,v=r(new m([[1,y,1],[1,y,-1],[-1,y,-1],[-1,y,1]])),x=[],w=Object(k.a)(n.columns.entries());try{for(w.s();!(d=w.n()).done;){var z=Object(c.a)(d.value,2),I=z[0],M=z[1];I%2||x.push(r(new m([[M,y,1],[M,y,-1]])))}}catch(E){w.e(E)}finally{w.f()}var P,_=[],N=Object(k.a)(function(t,e,n){var a=(e-t)/(arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?n:n-1);return Array.from({length:n},(function(e,n){return t+a*n}))}(1,-1,5));try{for(N.s();!(P=N.n()).done;){var W=P.value;_.push(r(new m([[-1,y,W],[1,y,W]]))),_.push(r(new m([[u,-1,W],[u,1,W]]))),s.push({text:"F",position:r(new O([u,y,W]))})}}catch(E){N.e(E)}finally{N.f()}return Object(a.useEffect)((function(){Object(o.h)(".xWall").data(h),Object(o.h)(".yWall").data(v)})),Object(g.jsxs)("g",{children:[Object(g.jsx)("path",{className:"xWall",d:h.data,opacity:"60%",fill:"grey"}),l.map((function(t){return Object(g.jsx)("path",{className:"",d:t.data,stroke:"lightgrey",strokeWidth:"2"})})),Object(g.jsx)("path",{className:"yWall",d:v.data,opacity:"60%",fill:"grey"}),x.map((function(t){return Object(g.jsx)("path",{className:"",d:t.data,stroke:"lightgrey",strokeWidth:"2"})})),_.map((function(t){return Object(g.jsx)("path",{className:"",d:t.data,stroke:"lightgrey",strokeWidth:"2"})}))]})},z=function(t){var e,n=t.df,r=t.trf,i=t.angles,s=r(new m([[1,1,1.075],[1,-1,1.075],[-1,-1,1.075],[-1,1,1.075]])),u=[],h=[],l=i.alpha<Math.PI?-1.15:1.15,f=Object(k.a)(n.index.entries());try{for(f.s();!(e=f.n()).done;){var p=Object(c.a)(e.value,2),j=p[0],b=p[1];if(!(j%2)){var d=r(new m([[-1,b,1.075],[1,b,1.075]]));u.push(d),h.push({text:n.labels.index[j],position:r(new O([l,b,1.1]))})}}}catch(P){f.e(P)}finally{f.f()}var y,v=i.alpha<1.5*Math.PI&&i.alpha>.5*Math.PI?-1.15:1.15,x=Object(k.a)(n.columns.entries());try{for(x.s();!(y=x.n()).done;){var w=Object(c.a)(y.value,2),z=w[0],I=w[1];if(!(z%2)){var M=r(new m([[I,-1,1.075],[I,1,1.075]]));u.push(M),h.push({text:n.labels.columns[z],position:r(new O([I,v,1.1]))})}}}catch(P){x.e(P)}finally{x.f()}return Object(a.useEffect)((function(){return Object(o.h)(".floor").selectAll(".base").data(s)})),Object(g.jsxs)("g",{children:[Object(g.jsx)("path",{className:"floor base",d:s.data,opacity:"60%",fill:"grey"}),u.map((function(t){return Object(g.jsx)("path",{className:"floor grid",d:t.data,stroke:"lightgrey",strokeWidth:"1"})})),h.map((function(t){var e=t.text,n=t.position;return Object(g.jsx)("text",{x:n.x-12,y:n.z+2,children:e.toFixed(2),fontSize:12})}))]})},I={alpha:7*Math.PI/4,beta:0,gamma:7*Math.PI/4},M=function(t){var e=t.df,n=t.width,r=t.height,i=Object(a.useState)(I),s=Object(c.a)(i,2),h=s[0],l=s[1],f=Object(a.useRef)({x:0,y:0}),p=function(t){f.current={x:t.x,y:t.y}},b=function(t){return l({alpha:Object(u.c)(h.alpha+(t.x-f.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.c)(h.gamma-(t.y-f.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(o.c)().on("start",p).on("drag",b);Object(o.g)("svg").call(t),Object(o.h)(".three").sort(j)}));var d=Object(o.f)(o.d).domain([1,-1]),y=function(t){return t.rotate(h).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500])};return Object(g.jsxs)("svg",{width:n,height:r,children:[Object(g.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(g.jsx)(z,{df:e,trf:y,angles:h}),Object(g.jsx)(w,{df:e,trf:y,angles:h}),Object(g.jsx)(x,{df:e,angles:h,colorScale:d})]}),Object(g.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(g.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(g.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},P=function(){var t=Object(a.useState)(null),e=Object(c.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(f).then(p).then(r)}),[]),n?Object(g.jsx)("div",{children:Object(g.jsx)(M,{df:n,width:900,height:600})}):"Loading..."};s.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(P,{})}),document.getElementById("root"))}},[[178,1,2]]]);
//# sourceMappingURL=main.c46fcdc1.chunk.js.map