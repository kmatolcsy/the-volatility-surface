(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{163:function(t,e){},165:function(t,e,n){"use strict";n.r(e);var a=n(4),r=n.n(a),c=n(73),i=n.n(c),s=n(2),o=n(3),u=n(168),h=function(t){var e=t.columns[0],n=t.columns.slice(1);return{columns:n.map((function(t){return+t})),values:t.map((function(t){return n.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[e]}))}},l=function(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=a?n-1:n,c=(e-t)/r;return Array.from({length:n},(function(e,n){return t+c*n}))},f=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},p=n(9),b=n(10),j=n(167),O=n(11),v=function(){function t(e){Object(p.a)(this,t),this.coordinates=e;var n=Object(s.a)(e,3),a=n[0],r=n[1],c=n[2];this.vector=Object(u.c)([[a],[r],[c],[1]])}return Object(b.a)(t,[{key:"scale",value:function(t){var e=Object(s.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(u.c)([[n,0,0,0],[0,a,0,0],[0,0,r,0],[0,0,0,1]]);return this.vector=Object(u.h)(c,this.vector),this}},{key:"apply",value:function(t){return this.vector=Object(u.h)(t,this.vector),this}},{key:"perspective",value:function(t,e,n){var a=Object(u.k)(.5*(Math.PI-t)),r=2*e*n/(e-n),c=(e+n)/(e-n),i=Object(u.c)([[a,0,0,0],[0,+c,0,r],[0,0,a,0],[0,-1,0,0]]);return this.vector=Object(u.h)(i,this.vector),this}},{key:"x",get:function(){return this.vector.subset(Object(u.b)(0,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"y",get:function(){return this.vector.subset(Object(u.b)(1,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"z",get:function(){return this.vector.subset(Object(u.b)(2,0))/this.vector.subset(Object(u.b)(3,0))}}]),t}(),m=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();Object(p.a)(this,t),this.points=e.map((function(t){return new v(t)})),this.generator=n}return Object(b.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"apply",value:function(t){return this.points=this.points.map((function(e){return e.apply(t)})),this}},{key:"perspective",value:function(t,e,n){return this.points=this.points.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.e)(this.points.map((function(t){return t.x}))),y:Object(u.e)(this.points.map((function(t){return t.y}))),z:Object(u.e)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=0,e=[].concat(Object(O.a)(this.points),[this.points[0]]),n=0;n<e.length-1;n++){var a=e[n],r=e[n+1];t+=(r.x-a.x)*(r.z+a.z)}return t}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.e)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),y=function(){function t(e){Object(p.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t){var e=Object(u.d)(t)-Object(u.f)(t);return e?[.5*Object(u.j)(Object(j.a)(t)),.5*e]:[0,1]},a=n(e.columns),r=Object(s.a)(a,2),c=r[0],i=r[1],o=n(e.index),h=Object(s.a)(o,2),l=h[0],f=h[1],b=n(e.values.flat()),O=Object(s.a)(b,2),v=O[0],y=O[1],d=function(t,n){return[(e.columns[n]-c)/i,(e.index[t]-l)/f,(e.values[t][n]-v)/-y]},g=function(t,e){return[d(t,e),d(t,e+1),d(t+1,e+1),d(t+1,e)]},x=0;x<e.index.length-1;x++)for(var k=0;k<e.columns.length-1;k++)this.polygons.push(new m(g(x,k)))}return Object(b.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"apply",value:function(t){return this.polygons=this.polygons.map((function(e){return e.apply(t)})),this}},{key:"perspective",value:function(t,e,n){return this.polygons=this.polygons.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.e)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.e)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.e)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(f)}}]),t}(),d=n(1),g=function(t){var e=t.df,n=t.camera,r=new y(e).apply(n.view).perspective(Math.PI/8,1,200).scale([300,300,300]);Object(a.useEffect)((function(){return Object(o.h)(".marks").data(r.paths)}));var c=Object(o.f)(o.d).domain([1,-1]);return r.paths.map((function(t,e){return Object(d.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(o.a)(c(t.colorValue)).darker():c(t.colorValue)},e)}))},x=n(12),k=function(t){var e=t.df,n=t.camera,r=t.angles,c=r.alpha<Math.PI?-1.075:1.075,i=e.index.map((function(){return l(1,-1,e.columns.length)})),s=new y(Object(x.a)(Object(x.a)({},e),{},{columns:Array(e.columns.length).fill(c),values:i})).apply(n.view).perspective(Math.PI/8,1,200).scale([300,300,300]),u=r.alpha>1.5*Math.PI||r.alpha<.5*Math.PI?-1.075:1.075,h=l(1,-1,e.index.length).map((function(t){return Array(e.columns.length).fill(t)})),f=new y(Object(x.a)(Object(x.a)({},e),{},{index:Array(e.index.length).fill(u),values:h})).apply(n.view).perspective(Math.PI/8,1,200).scale([300,300,300]);return Object(a.useEffect)((function(){Object(o.h)(".xWall").data(s.paths),Object(o.h)(".yWall").data(f.paths)})),Object(d.jsxs)("g",{children:[s.paths.map((function(t,e){return Object(d.jsx)("path",{className:"xWall",d:t.data,opacity:"0.6",fill:"gray"},e)})),f.paths.map((function(t,e){return Object(d.jsx)("path",{className:"yWall",d:t.data,opacity:"0.6",fill:"gray"},e)}))]})},w=function(t){var e=t.df,n=t.camera,r=new y(Object(x.a)(Object(x.a)({},e),{},{values:e.values.map((function(t){return t.map((function(){return-1.075}))}))})).apply(n.view).perspective(Math.PI/8,1,200).scale([300,300,300]);return Object(a.useEffect)((function(){return Object(o.h)(".floor").data(r.paths)})),r.paths.map((function(t,e){return Object(d.jsx)("path",{className:"floor",d:t.data,opacity:"0.6",fill:"gray"},e)}))},I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];Object(p.a)(this,t);var n=Object(s.a)(e,3),a=n[0],r=n[1],c=n[2];this.transformations=Object(u.c)([[1,0,0,a],[0,1,0,r],[0,0,1,c],[0,0,0,1]])}return Object(b.a)(t,[{key:"_rotateX",value:function(t){var e=Object(u.a)(t),n=Object(u.i)(t);return Object(u.c)([[1,0,0,0],[0,e,-n,0],[0,n,+e,0],[0,0,0,1]])}},{key:"_rotateY",value:function(t){var e=Object(u.a)(t),n=Object(u.i)(t);return Object(u.c)([[+e,0,n,0],[0,1,0,0],[-n,0,e,0],[0,0,0,1]])}},{key:"_rotateZ",value:function(t){var e=Object(u.a)(t),n=Object(u.i)(t);return Object(u.c)([[e,-n,0,0],[n,+e,0,0],[0,0,1,0],[0,0,0,1]])}},{key:"scale",value:function(t){var e=Object(s.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(u.c)([[n,0,0,0],[0,a,0,0],[0,0,r,0],[0,0,0,1]]);return this.transformations=Object(u.h)(c,this.transformations),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];this.translate(e.map((function(t){return-t})));var n=[this._rotateX(t.gamma),this._rotateY(t.beta),this._rotateZ(t.alpha)],a=n.reduce((function(t,e){return Object(u.h)(t,e)}));return this.transformations=Object(u.h)(a,this.transformations),this.translate(e),this}},{key:"translate",value:function(t){var e=Object(s.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(u.c)([[1,0,0,n],[0,1,0,a],[0,0,1,r],[0,0,0,1]]);return this.transformations=Object(u.h)(c,this.transformations),this}},{key:"view",get:function(){return this.transformations}}]),t}(),M={alpha:Math.PI/4,beta:0,gamma:Math.PI/4},P=function(t){var e=t.df,n=t.width,r=t.height,c=Object(a.useState)(M),i=Object(s.a)(c,2),h=i[0],l=i[1],p=Object(a.useRef)({x:0,y:0}),b=function(t){p.current={x:t.x,y:t.y}},j=function(t){return l({alpha:Object(u.g)(h.alpha-(t.x-p.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.g)(h.gamma+(t.y-p.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(o.c)().on("start",b).on("drag",j).on("end",(function(t){return console.log("end")}));Object(o.g)("svg").call(t),Object(o.h)(".three").sort(f)}));var O=(new I).rotate(h).translate([0,-10,0]);return Object(d.jsxs)("svg",{width:n,height:r,children:[Object(d.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(d.jsx)(w,{df:e,camera:O}),Object(d.jsx)(k,{df:e,camera:O,angles:h}),Object(d.jsx)(g,{df:e,camera:O})]}),Object(d.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(d.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(d.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},_=function(){var t=Object(a.useState)(null),e=Object(s.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(h).then(r)}),[]),n?Object(d.jsx)("div",{children:Object(d.jsx)(P,{df:n,width:900,height:600})}):"Loading..."};i.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(_,{})}),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.f7cd7f57.chunk.js.map