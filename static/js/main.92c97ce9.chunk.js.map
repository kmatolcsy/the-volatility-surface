{"version":3,"sources":["utils.js","Point3D.js","Polygon3D.js","Surface3D.js","Marks.js","Walls.js","Floor.js","Surface.js","App.js","index.js"],"names":["readData","data","columns","slice","index_name","map","column","values","row","index","normDataframe","dataframe","scaleColumns","scaleLinear","domain","extent","range","scaleValues","flat","nice","scaleIndex","x","labels","linspace","start","stop","num","endpoint","div","step","Array","from","length","_","i","compare","a","b","centroid","Point3D","coordinates","this","y","z","w","gamma","cos","sin","beta","alpha","angles","center","translate","c","_rotateZ","_rotateY","_rotateX","fieldOfView","near","far","tan","Math","PI","Polygon3D","points","generator","line","point","scale","rotate","perspective","mean","ans","p1","p2","Surface3D","df","polygons","coords","j","push","polygon","sort","Marks","colorScale","marks","useEffect","selectAll","paths","path","className","d","fill","area","color","colorValue","darker","labelPosition","Walls","trf","stroke","strokeWidth","xBase","xGrid","entries","yBase","yGrid","end","labelText","zGrid","text","toFixed","position","strokeLinecap","children","fontSize","fontFamily","Floor","base","grid","initialAngles","Surface","width","height","useState","setAngles","entryPoint","useRef","handleStart","event","current","handleDrag","mod","dragBehaviour","drag","on","select","call","scaleColor","scaleSequential","interpolateViridis","obj","transform","App","setDataframe","csv","then","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.92c97ce9.chunk.js","sourcesContent":["import { extent } from \"d3-array\"\r\nimport { scaleLinear } from \"d3-scale\"\r\n\r\nexport const readData = data => {\r\n    let columns = data.columns.slice(1)\r\n    const index_name = data.columns[0]\r\n\r\n    return {\r\n        columns: columns.map(column => +column),\r\n        values: data.map(row => columns.map(column => +row[column])),\r\n        index: data.map(row => +row[index_name])\r\n    }\r\n}\r\n\r\nexport const normDataframe = dataframe => {\r\n    // values are inverted\r\n    const scaleColumns = scaleLinear().domain(extent(dataframe.columns)).range([-1, 1])\r\n    const scaleValues = scaleLinear().domain(extent(dataframe.values.flat())).range([1, -1]).nice()\r\n    const scaleIndex = scaleLinear().domain(extent(dataframe.index)).range([-1, 1])\r\n\r\n    return {\r\n        columns: dataframe.columns.map(x => scaleColumns(x)),\r\n        values: dataframe.values.map(row => row.map(x => scaleValues(x))),\r\n        index: dataframe.index.map(x=> scaleIndex(x)),\r\n        domain: scaleValues.domain(),\r\n        labels: dataframe\r\n        \r\n    }\r\n}\r\n\r\nexport const linspace = (start, stop, num, endpoint = true) => {\r\n    const div = endpoint ? (num - 1) : num;\r\n    const step = (stop - start) / div;\r\n    return Array.from({ length: num }, (_, i) => start + step * i);\r\n}\r\n\r\nexport const compare = (a, b) => {\r\n    const coord = 'y'\r\n\r\n    if (a.centroid[coord] < b.centroid[coord]) return +1\r\n    if (a.centroid[coord] > b.centroid[coord]) return -1\r\n    return 0\r\n}\r\n","import { cos, sin, tan } from 'mathjs';\r\n\r\nexport class Point3D {\r\n    constructor(coordinates) {\r\n        // original coordinates\r\n        this.coordinates = coordinates\r\n\r\n        // mutable coordinates\r\n        this.x = coordinates[0]\r\n        this.y = coordinates[1]\r\n        this.z = coordinates[2]\r\n        this.w = 1\r\n    }\r\n\r\n    _rotateX(gamma) {\r\n        const { y, z } = this\r\n\r\n        this.y = cos(gamma) * y + sin(gamma) * z\r\n        this.z = cos(gamma) * z - sin(gamma) * y\r\n    }\r\n\r\n    _rotateY(beta) {\r\n        const { x, z } = this\r\n\r\n        this.x = cos(beta) * x - sin(beta) * z\r\n        this.z = cos(beta) * z + sin(beta) * x\r\n    }\r\n\r\n    _rotateZ(alpha) {\r\n        const { x, y } = this\r\n\r\n        this.x = cos(alpha) * x + sin(alpha) * y\r\n        this.y = cos(alpha) * y - sin(alpha) * x\r\n    }\r\n\r\n    scale(coordinates) {\r\n        this.x *= coordinates[0]\r\n        this.y *= coordinates[1]\r\n        this.z *= coordinates[2]\r\n\r\n        return this\r\n    }\r\n\r\n    rotate(angles, center = [0, 0, 0]) {\r\n        // \r\n        this.translate(center.map(c => -c))\r\n\r\n        this._rotateZ(angles.alpha)\r\n        this._rotateY(angles.beta)\r\n        this._rotateX(angles.gamma)\r\n\r\n        //\r\n        this.translate(center)\r\n\r\n        return this\r\n    }\r\n\r\n    translate(coordinates) {\r\n        this.x += coordinates[0]\r\n        this.y += coordinates[1]\r\n        this.z += coordinates[2]\r\n\r\n        return this\r\n    }\r\n\r\n    perspective(fieldOfView, near, far) {\r\n        const { x, y, z } = this\r\n\r\n        // aux variables\r\n        const a = tan((Math.PI - fieldOfView) / 2)\r\n        const b = (near + far) / (2 * near * far)\r\n        const c = (2 * near * far) / (near - far)\r\n\r\n        this.x = a * x / (c * y)\r\n        this.y = b - 1 / (c * y)\r\n        this.z = a * z / (c * y)\r\n\r\n        return this\r\n    }\r\n\r\n    get centroid() {\r\n        return { x: this.x, y: this.y, z: this.z }\r\n    }\r\n}","import { mean } from 'mathjs'\r\nimport { line } from 'd3'\r\n\r\nimport { Point3D } from './Point3D'\r\n\r\nexport class Polygon3D {\r\n    constructor(points, generator = line()) {\r\n        this.points = points.map(point => new Point3D(point))\r\n        this.generator = generator\r\n    }\r\n\r\n    scale(coordinates) {\r\n        this.points = this.points.map(point => point.scale(coordinates))\r\n        return this\r\n    }\r\n\r\n    rotate(angles, center = [0, 0, 0]) {\r\n        this.points = this.points.map(point => point.rotate(angles, center))\r\n        return this\r\n    }\r\n\r\n    translate(coordinates) {\r\n        this.points = this.points.map(point => point.translate(coordinates))\r\n        return this\r\n    }\r\n\r\n    perspective(fieldOfView, near, far) {\r\n        this.points = this.points.map(point => point.perspective(fieldOfView, near, far))\r\n        return this\r\n    }\r\n\r\n    get centroid() {\r\n        return {\r\n            x: mean(this.points.map(point => point.x)),\r\n            y: mean(this.points.map(point => point.y)),\r\n            z: mean(this.points.map(point => point.z))\r\n        }\r\n    }\r\n\r\n    get area() {\r\n        const points = [...this.points, this.points[0]]\r\n        let ans = 0\r\n\r\n        for (let i = 0; i < points.length - 1; i++) {\r\n\r\n            let p1 = points[i]\r\n            let p2 = points[i + 1]\r\n\r\n            ans += (p2.x - p1.x) * (p2.z + p1.z)\r\n        }\r\n\r\n        return ans\r\n    }\r\n\r\n    get data() {\r\n        // orthogonal projection\r\n        return this.generator(this.points.map(point => [point.x, point.z]))\r\n    }\r\n\r\n    get colorValue() {\r\n        // mean of original z-values\r\n        return mean(this.points.map(point => point.coordinates[2]))\r\n    }\r\n}","import { mean } from 'mathjs'\r\n\r\nimport { Polygon3D } from './Polygon3D'\r\nimport { compare } from './utils'\r\n\r\nexport class Surface3D {\r\n    constructor(df) {\r\n        this.df = df\r\n\r\n        this.polygons = [] // paths\r\n\r\n        const coords = (i, j) => [\r\n            df.columns[j], df.index[i], df.values[i][j]\r\n        ]\r\n\r\n        const points = (i, j) => [\r\n            coords(i, j), coords(i, j + 1), coords(i + 1, j + 1), coords(i + 1, j),\r\n        ]\r\n\r\n        for (let i = 0; i < df.index.length - 1; i++) {\r\n            for (let j = 0; j < df.columns.length - 1; j++) {\r\n                this.polygons.push(new Polygon3D(points(i, j)))\r\n            }\r\n        }\r\n    }\r\n\r\n    scale(coordinates) {\r\n        this.polygons = this.polygons.map(polygon => polygon.scale(coordinates))\r\n        return this\r\n    }\r\n\r\n    rotate(angles, center = [0, 0, 0]) {\r\n        this.polygons = this.polygons.map(polygon => polygon.rotate(angles, center))\r\n        return this\r\n    }\r\n\r\n    translate(coordinates) {\r\n        this.polygons = this.polygons.map(polygon => polygon.translate(coordinates))\r\n        return this\r\n    }\r\n\r\n    perspective(fieldOfView, near, far) {\r\n        this.polygons = this.polygons.map(polygon => polygon.perspective(fieldOfView, near, far))\r\n        return this\r\n    }\r\n\r\n    get centroid() {\r\n        return {\r\n            x: mean(this.polygons.map(polygon => polygon.centroid.x)),\r\n            y: mean(this.polygons.map(polygon => polygon.centroid.y)),\r\n            z: mean(this.polygons.map(polygon => polygon.centroid.z))\r\n        }\r\n    }\r\n\r\n    get paths() {\r\n        return this.polygons.sort(compare)\r\n    }\r\n}","import { useEffect } from 'react'\r\nimport { selectAll, color } from 'd3'\r\n\r\nimport { Surface3D } from './Surface3D'\r\n\r\nexport const Marks = ({ df, angles, colorScale }) => {\r\n    let marks = new Surface3D(df)\r\n        .rotate(angles)\r\n        .translate([0, -10, 0])\r\n        .perspective(Math.PI / 8, 1, 200)\r\n        .scale([500, 500, 500])\r\n\r\n    // bind the data to the DOM elemenents\r\n    useEffect(() => selectAll('.marks').data(marks.paths))\r\n\r\n    return marks.paths.map((path, index) => <path\r\n        className='three marks'\r\n        key={index}\r\n        d={path.data}\r\n        fill={path.area > 0 ? color(colorScale(path.colorValue)).darker() : colorScale(path.colorValue)}\r\n    />)\r\n}\r\n","import { useEffect } from 'react'\r\nimport { selectAll } from 'd3'\r\n\r\nimport { Polygon3D } from './Polygon3D'\r\nimport { linspace } from './utils'\r\nimport { Point3D } from './Point3D'\r\n\r\n\r\nconst labelPosition = (angles, z) => {\r\n    if (angles.alpha < Math.PI / 2) return [-1.3, -1.3, z]\r\n    if (angles.alpha < Math.PI) return [1.3, -1.3, z]\r\n    if (angles.alpha < 3 * Math.PI / 2) return [1.3, 1.3, z]\r\n    return [-1.3, 1.3, z]\r\n}\r\n\r\n\r\nexport const Walls = ({ df, trf, angles }) => {\r\n    const fill = '#E5E2E0'\r\n    const stroke = 'white'\r\n    const strokeWidth = '1px'\r\n\r\n    let labels = []\r\n\r\n    // xWall\r\n    const x = angles.alpha > Math.PI ? -1.075 : 1.075\r\n\r\n    let xBase = trf(new Polygon3D([[x, 1, 1], [x, 1, -1], [x, -1, -1], [x, -1, 1]]))\r\n    let xGrid = []\r\n\r\n    for (let [i, y] of df.index.entries()) {\r\n\r\n        if (i % 2) continue\r\n\r\n        xGrid.push(\r\n            trf(new Polygon3D([[x, y, 1], [x, y, -1]]))\r\n        )\r\n    }\r\n\r\n    // yWall\r\n    const y = angles.alpha > 1.5 * Math.PI || angles.alpha < 0.5 * Math.PI ? -1.075 : 1.075\r\n\r\n    let yBase = trf(new Polygon3D([[1, y, 1], [1, y, -1], [-1, y, -1], [-1, y, 1]]))\r\n    let yGrid = []\r\n\r\n    for (let [i, x] of df.columns.entries()) {\r\n\r\n        if (i % 2) continue\r\n\r\n        yGrid.push(\r\n            trf(new Polygon3D([[x, y, 1], [x, y, -1]]))\r\n        )\r\n    }\r\n\r\n    const [start, end] = df.domain\r\n    const step = 5\r\n\r\n    let labelText = linspace(start, end, step)\r\n    let zGrid = []\r\n\r\n    for (let [i, z] of linspace(1, -1, step).entries()) {\r\n\r\n        zGrid.push(\r\n            trf(new Polygon3D([[-1, y, z], [1, y, z]]))\r\n        )\r\n\r\n        zGrid.push(\r\n            trf(new Polygon3D([[x, -1, z], [x, 1, z]]))\r\n        )\r\n\r\n        labels.push({\r\n            text: labelText[i].toFixed(2),\r\n            position: trf(new Point3D(labelPosition(angles, z)))\r\n        })\r\n    }\r\n\r\n    // bind the data to the DOM elemenents\r\n    useEffect(() => {\r\n        // selectAll('.xWall').data(xWall)\r\n        // selectAll('.yWall').data(yWall)\r\n    })\r\n\r\n    return (<g>\r\n        {<path\r\n            className='xWall base'\r\n            d={xBase.data}\r\n            fill={fill}\r\n        />}\r\n        {xGrid.map(line => <path\r\n            className=''\r\n            d={line.data}\r\n            stroke={stroke}\r\n            strokeWidth={strokeWidth}\r\n            strokeLinecap='square'\r\n        />)}\r\n        {<path\r\n            className='yWall base'\r\n            d={yBase.data}\r\n            fill={fill}\r\n        />}\r\n        {yGrid.map(line => <path\r\n            className=''\r\n            d={line.data}\r\n            stroke={stroke}\r\n            strokeWidth={strokeWidth}\r\n            strokeLinecap='square'\r\n        />)}\r\n        {zGrid.map(line => <path\r\n            className=''\r\n            d={line.data}\r\n            stroke={stroke}\r\n            strokeWidth={strokeWidth}\r\n            strokeLinecap='square'\r\n        />)}\r\n        {labels.map(({ text, position }) => <text\r\n            x={position.x}\r\n            y={position.z + 6}\r\n            children={text}\r\n            fontSize='0.9rem'\r\n            fill='#635F5D'\r\n            fontFamily='Roboto, sans-serif'\r\n        />)}\r\n    </g>)\r\n}","import { useEffect } from 'react'\r\nimport { selectAll } from 'd3'\r\n\r\nimport { Polygon3D } from './Polygon3D'\r\nimport { Point3D } from './Point3D'\r\n\r\nexport const Floor = ({ df, trf, angles }) => {\r\n    const fill = '#E5E2E0'\r\n    const stroke = 'white'\r\n    const strokeWidth = '1px'\r\n    const labelOffset = 0.25\r\n\r\n    let base = trf(new Polygon3D([[1, 1, 1.075], [1, -1, 1.075], [-1, -1, 1.075], [-1, 1, 1.075]]))\r\n    let grid = []\r\n    let labels = []\r\n\r\n    const x = angles.alpha < Math.PI ? -1 - labelOffset : 1 + labelOffset\r\n\r\n    for (let [i, y] of df.index.entries()) {\r\n\r\n        if (i % 2) continue\r\n\r\n        grid.push(\r\n            trf(new Polygon3D([[-1, y, 1.075], [1, y, 1.075]]))\r\n        )\r\n\r\n        labels.push({\r\n            text: df.labels.index[i],\r\n            position: trf(new Point3D([x, y, 1.1]))\r\n        })\r\n    }\r\n\r\n    const y = angles.alpha < 1.5 * Math.PI && angles.alpha > 0.5 * Math.PI ? -1 - labelOffset : 1 + labelOffset\r\n\r\n    for (let [i, x] of df.columns.entries()) {\r\n\r\n        if (i % 2) continue\r\n\r\n        grid.push(\r\n            trf(new Polygon3D([[x, -1, 1.075], [x, 1, 1.075]]))\r\n        )\r\n\r\n        labels.push({\r\n            text: df.labels.columns[i],\r\n            position: trf(new Point3D([x, y, 1.1]))\r\n        })\r\n    }\r\n\r\n    // bind the data to the DOM elemenents\r\n    useEffect(() => selectAll('.floor').selectAll('.base').data(base))\r\n\r\n    return (\r\n        <g>\r\n            {<path\r\n                className='floor base'\r\n                d={base.data}\r\n                fill={fill}\r\n            />}\r\n            {grid.map(line => <path\r\n                className='floor grid'\r\n                d={line.data}\r\n                stroke={stroke}\r\n                strokeWidth={strokeWidth}\r\n                strokeLinecap='square'\r\n            />)}\r\n            {labels.map(({ text, position }) => <text\r\n                className='floor label'\r\n                x={position.x - 12}\r\n                y={position.z + 2}\r\n                children={text.toFixed(2)}\r\n                fontSize='0.9rem'\r\n                fill='#635F5D'\r\n                fontFamily='Roboto, sans-serif'\r\n            />)}\r\n        </g>\r\n    )\r\n}","import { useState, useEffect, useRef } from 'react';\r\nimport { selectAll, select, drag, scaleSequential, interpolateViridis } from 'd3';\r\nimport { mod } from 'mathjs';\r\n\r\n// import { Point3D } from './Point3D';\r\nimport { compare } from './utils';\r\nimport { Marks } from './Marks';\r\nimport { Walls } from './Walls';\r\nimport { Floor } from './Floor';\r\n\r\n\r\nconst initialAngles = {\r\n    alpha: 7 * Math.PI / 4,\r\n    beta: 0,\r\n    gamma: 7 * Math.PI / 4\r\n}\r\n\r\nexport const Surface = ({ df, width, height }) => {\r\n    let [angles, setAngles] = useState(initialAngles)\r\n    let entryPoint = useRef({ x: 0, y: 0 })\r\n\r\n    // dragging behaviour\r\n    const handleStart = event => {\r\n        entryPoint.current = { x: event.x, y: event.y }\r\n    }\r\n\r\n    const handleDrag = event => setAngles({\r\n        alpha: mod(angles.alpha + (event.x - entryPoint.current.x) / 300 * Math.PI, 2 * Math.PI),\r\n        beta: angles.beta,\r\n        gamma: mod(angles.gamma - (event.y - entryPoint.current.y) / 300 * Math.PI, 2 * Math.PI)\r\n    })\r\n\r\n    useEffect(() => {\r\n        const dragBehaviour = drag()\r\n            .on('start', handleStart)\r\n            .on('drag', handleDrag)\r\n        // .on('end', event => console.log('end'))\r\n\r\n        select('svg').call(dragBehaviour)\r\n\r\n        selectAll('.three').sort(compare)\r\n    })\r\n\r\n    // objects NOTE: creating new objects for every render might lead to performance issues\r\n    const scaleColor = scaleSequential(interpolateViridis).domain([1, -1])\r\n\r\n    const trf = obj => obj\r\n        .rotate(angles)\r\n        .translate([0, -10, 0])\r\n        .perspective(Math.PI / 8, 1, 200)\r\n        .scale([500, 500, 500])\r\n\r\n\r\n    return (\r\n        <svg width={width} height={height}>\r\n            <g transform={`translate(${width / 2}, ${height / 2})`}>\r\n                <Floor df={df} trf={trf} angles={angles} />\r\n                <Walls df={df} trf={trf} angles={angles} />\r\n                <Marks df={df} angles={angles} colorScale={scaleColor} />\r\n            </g>\r\n            <text x={10} y={10}>Alpha: {angles.alpha}</text>\r\n            <text x={10} y={30}>Beta: {angles.beta}</text>\r\n            <text x={10} y={50}>Gamma: {angles.gamma}</text>\r\n        </svg>\r\n    )\r\n}","import { useState, useEffect } from 'react';\nimport { csv } from 'd3';\n\nimport { Surface } from './Surface'\nimport { readData, normDataframe } from './utils'\n\n\nconst url = 'https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv'\n\nexport const App = () => {\n  let [dataframe, setDataframe] = useState(null)\n\n  // before rendering\n  useEffect(\n    () => csv(url)\n      .then(readData)\n      .then(normDataframe)\n      .then(setDataframe),\n    []\n  )\n\n  if (!dataframe)\n    return 'Loading...'\n\n  return (\n    <div>\n      <Surface df={dataframe} width={900} height={600} />\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}