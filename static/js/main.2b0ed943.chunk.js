(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{223:function(t,e){},225:function(t,e,n){"use strict";n.r(e);var r=n(4),c=n.n(r),a=n(89),i=n.n(a),s=n(1),o=n(3),u=n(227),h=function(t){var e=t.columns[0],n=t.columns.slice(1);return{columns:n.map((function(t){return+t})),values:t.map((function(t){return n.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[e]}))}},l=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},f=n(10),j=n(11),b=n(12),p=function(){function t(e){Object(f.a)(this,t),this.coordinates=e;var n=Object(s.a)(e,3),r=n[0],c=n[1],a=n[2];this.vector=Object(u.e)([[r],[c],[a],[1]])}return Object(j.a)(t,[{key:"scale",value:function(t){var e=Object(s.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.e)([[n,0,0,0],[0,r,0,0],[0,0,c,0],[0,0,0,1]]);return this.vector=Object(u.j)(a,this.vector),this}},{key:"translate",value:function(t){var e=Object(s.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.e)([[1,0,0,n],[0,1,0,r],[0,0,1,c],[0,0,0,1]]);return this.vector=Object(u.j)(a,this.vector),this}},{key:"apply",value:function(t){return this.vector=Object(u.j)(t,this.vector),this}},{key:"perspective",value:function(t,e,n,r){var c=Object(u.l)(.5*(Math.PI-t)),a=1/(n-r),i=c/e,s=a*(n+r),o=c,h=2*a*n*r,l=Object(u.e)([[i,0,0,0],[0,+s,0,h],[0,0,o,0],[0,-1,0,0]]);return this.vector=Object(u.j)(l,this.vector),this}},{key:"x",get:function(){return this.vector.subset(Object(u.c)(0,0))/this.vector.subset(Object(u.c)(3,0))}},{key:"y",get:function(){return this.vector.subset(Object(u.c)(1,0))/this.vector.subset(Object(u.c)(3,0))}},{key:"z",get:function(){return this.vector.subset(Object(u.c)(2,0))/this.vector.subset(Object(u.c)(3,0))}}]),t}(),O=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.f)();Object(f.a)(this,t),this.points=e.map((function(t){return new p(t)})),this.generator=n}return Object(j.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.points=this.points.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.points=this.points.map((function(e){return e.translate(t)})),this}},{key:"apply",value:function(t){return this.points=this.points.map((function(e){return e.apply(t)})),this}},{key:"perspective",value:function(t,e,n,r){return this.points=this.points.map((function(c){return c.perspective(t,e,n,r)})),this}},{key:"centroid",get:function(){return{x:Object(u.g)(this.points.map((function(t){return t.x}))),y:Object(u.g)(this.points.map((function(t){return t.y}))),z:Object(u.g)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=0,e=[].concat(Object(b.a)(this.points),[this.points[0]]),n=0;n<e.length-1;n++){var r=e[n],c=e[n+1];t+=(c.x-r.x)*(c.z+r.z)}return t}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.g)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),v=function(){function t(e){Object(f.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},r=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},c=0;c<e.index.length-1;c++)for(var a=0;a<e.columns.length-1;a++)this.polygons.push(new O(r(c,a)))}return Object(j.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.polygons=this.polygons.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.polygons=this.polygons.map((function(e){return e.translate(t)})),this}},{key:"apply",value:function(t){return this.polygons=this.polygons.map((function(e){return e.apply(t)})),this}},{key:"perspective",value:function(t,e,n,r){return this.polygons=this.polygons.map((function(c){return c.perspective(t,e,n,r)})),this}},{key:"centroid",get:function(){return{x:Object(u.g)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.g)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.g)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(l)}}]),t}(),y=n(2),m=function(t){var e=t.df,n=t.camera,c=t.scaleColor,a=new v(e).apply(n.view).perspective(Math.PI/8,1,1,200).scale([500,500,500]);return Object(r.useEffect)((function(){return Object(o.i)(".marks").data(a.paths)})),a.paths.map((function(t,e){return Object(y.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(o.a)(c(t.colorValue)).darker():Object(o.a)(c(t.colorValue))},e)}))},g=(n(13),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];Object(f.a)(this,t),this.coordinates=e;var n=Object(s.a)(e,3),r=n[0],c=n[1],a=n[2];this.vector=Object(u.e)([[r],[c],[a],[1]]),this.transformations=Object(u.b)(4)}return Object(j.a)(t,[{key:"_rotateX",value:function(t){var e=Object(u.a)(t),n=Object(u.k)(t);return Object(u.e)([[1,0,0,0],[0,e,-n,0],[0,n,+e,0],[0,0,0,1]])}},{key:"_rotateY",value:function(t){var e=Object(u.a)(t),n=Object(u.k)(t);return Object(u.e)([[+e,0,n,0],[0,1,0,0],[-n,0,e,0],[0,0,0,1]])}},{key:"_rotateZ",value:function(t){var e=Object(u.a)(t),n=Object(u.k)(t);return Object(u.e)([[e,-n,0,0],[n,+e,0,0],[0,0,1,0],[0,0,0,1]])}},{key:"scale",value:function(t){var e=Object(s.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.e)([[n,0,0,0],[0,r,0,0],[0,0,c,0],[0,0,0,1]]);return this.transformations=Object(u.j)(a,this.transformations),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];this.translate(e.map((function(t){return-t})));var n=[this._rotateZ(t.alpha),this._rotateY(t.beta),this._rotateX(t.gamma)],r=n.reduce((function(t,e){return Object(u.j)(t,e)}));return this.transformations=Object(u.j)(r,this.transformations),this.translate(e),this}},{key:"translate",value:function(t){var e=Object(s.a)(t,3),n=e[0],r=e[1],c=e[2],a=Object(u.e)([[1,0,0,n],[0,1,0,r],[0,0,1,c],[0,0,0,1]]);return this.transformations=Object(u.j)(a,this.transformations),this}},{key:"view",get:function(){return Object(u.d)(this.transformations)}}]),t}()),d={alpha:Math.PI/4,beta:0,gamma:Math.PI/8},k=function(t){var e=t.df,n=t.width,c=t.height,a=Object(r.useState)(d),i=Object(s.a)(a,2),h=i[0],f=i[1],j=Object(r.useRef)({x:0,y:0}),b=function(t){j.current={x:t.x,y:t.y}},p=function(t){return f({alpha:Object(u.i)(h.alpha+(t.x-j.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.i)(h.gamma-(t.y-j.current.y)/300*Math.PI,2*Math.PI)})};Object(r.useEffect)((function(){var t=Object(o.c)().on("start",b).on("drag",p).on("end",(function(t){return console.log("end")}));Object(o.h)("svg").call(t),Object(o.i)(".three").sort(l)}));var O=Object(o.g)(o.e).domain(Object(o.d)(e.values.flat())),v=(new g).translate([1,16,1]).rotate(h,[1,1,1]).scale([(Object(u.f)(e.columns)-Object(u.h)(e.columns))/2,(Object(u.f)(e.index)-Object(u.h)(e.index))/2,(Object(u.h)(e.values.flat())-Object(u.f)(e.values.flat()))/2]).translate([Object(u.h)(e.columns),Object(u.h)(e.index),Object(u.f)(e.values.flat())]);return Object(y.jsxs)("svg",{width:n,height:c,children:[Object(y.jsx)("g",{transform:"translate(".concat(n/2,", ").concat(c/2,")"),children:Object(y.jsx)(m,{df:e,camera:v,scaleColor:O})}),Object(y.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(y.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(y.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},x=function(){var t=Object(r.useState)(null),e=Object(s.a)(t,2),n=e[0],c=e[1];return Object(r.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(h).then(c)}),[]),n?Object(y.jsx)("div",{children:Object(y.jsx)(k,{df:n,width:900,height:600})}):"Loading..."};i.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(x,{})}),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.2b0ed943.chunk.js.map