(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{176:function(t,e){},178:function(t,e,n){"use strict";n.r(e);var a=n(5),r=n.n(a),c=n(84),o=n.n(c),i=n(2),s=n(4),u=n(182),h=n(181),l=n(14),f=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},b=function(t){var e=Object(l.a)().domain(Object(h.a)(t.columns)).range([-1,1]),n=Object(l.a)().domain(Object(h.a)(t.values.flat())).range([1,-1]),a=Object(l.a)().domain(Object(h.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return a(t)}))}},j=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},O=n(15),p=n(16),d=n(17),m=function(){function t(e){Object(O.a)(this,t),this.coordinates=e;var n=Object(i.a)(e,3),a=n[0],r=n[1],c=n[2];this.vector=Object(u.c)([[a],[r],[c],[1]])}return Object(p.a)(t,[{key:"apply",value:function(t){return this.vector=Object(u.f)(t,this.vector),this}},{key:"x",get:function(){return this.vector.subset(Object(u.b)(0,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"y",get:function(){return this.vector.subset(Object(u.b)(1,0))/this.vector.subset(Object(u.b)(3,0))}},{key:"z",get:function(){return this.vector.subset(Object(u.b)(2,0))/this.vector.subset(Object(u.b)(3,0))}}]),t}(),v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(s.e)();Object(O.a)(this,t),this.points=e.map((function(t){return new m(t)})),this.generator=n}return Object(p.a)(t,[{key:"apply",value:function(t){return this.points=this.points.map((function(e){return e.apply(t)})),this}},{key:"centroid",get:function(){return{x:Object(u.d)(this.points.map((function(t){return t.x}))),y:Object(u.d)(this.points.map((function(t){return t.y}))),z:Object(u.d)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=0,e=[].concat(Object(d.a)(this.points),[this.points[0]]),n=0;n<e.length-1;n++){var a=e[n],r=e[n+1];t+=(r.x-a.x)*(r.z+a.z)}return t}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.d)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),y=function(){function t(e){Object(O.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},a=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},r=0;r<e.index.length-1;r++)for(var c=0;c<e.columns.length-1;c++)this.polygons.push(new v(a(r,c)))}return Object(p.a)(t,[{key:"apply",value:function(t){return this.polygons=this.polygons.map((function(e){return e.apply(t)})),this}},{key:"centroid",get:function(){return{x:Object(u.d)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.d)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.d)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(j)}}]),t}(),g=n(1),x=function(t){var e=t.df,n=t.camera,r=t.colorScale,c=new y(e).apply(n.view);return Object(a.useEffect)((function(){return Object(s.h)(".marks").data(c.paths)})),c.paths.map((function(t,e){return Object(g.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(s.a)(r(t.colorValue)).darker():r(t.colorValue)},e)}))},k=function(t){t.df;var e=t.camera,n=t.angles,r=n.alpha<Math.PI?-1.075:1.075,c=new v([[r,1,1],[r,1,-1],[r,-1,-1],[r,-1,1]]).apply(e.view),o=n.alpha>1.5*Math.PI||n.alpha<.5*Math.PI?-1.075:1.075,i=new v([[1,o,1],[1,o,-1],[-1,o,-1],[-1,o,1]]).apply(e.view);return Object(a.useEffect)((function(){Object(s.h)(".xWall").data(c),Object(s.h)(".yWall").data(i)})),Object(g.jsxs)("g",{children:[Object(g.jsx)("path",{className:"xWall",d:c.data,opacity:"60%",fill:"grey"}),Object(g.jsx)("path",{className:"yWall",d:i.data,opacity:"60%",fill:"grey"})]})},w=function(t){var e=t.camera,n=new v([[1,1,1.075],[1,-1,1.075],[-1,-1,1.075],[-1,1,1.075]]).apply(e.view);return Object(a.useEffect)((function(){return Object(s.h)(".floor").data(n)})),Object(g.jsx)("path",{className:"floor",d:n.data,opacity:"60%",fill:"grey"})},I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];Object(O.a)(this,t),console.log("camera");var n=Object(i.a)(e,3),a=n[0],r=n[1],c=n[2];this.transformations=Object(u.c)([[1,0,0,a],[0,1,0,r],[0,0,1,c],[0,0,0,1]])}return Object(p.a)(t,[{key:"_rotateX",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[1,0,0,0],[0,e,-n,0],[0,n,+e,0],[0,0,0,1]])}},{key:"_rotateY",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[+e,0,n,0],[0,1,0,0],[-n,0,e,0],[0,0,0,1]])}},{key:"_rotateZ",value:function(t){var e=Object(u.a)(t),n=Object(u.g)(t);return Object(u.c)([[e,-n,0,0],[n,+e,0,0],[0,0,1,0],[0,0,0,1]])}},{key:"scale",value:function(t){var e=Object(i.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(u.c)([[n,0,0,0],[0,a,0,0],[0,0,r,0],[0,0,0,1]]);return this.transformations=Object(u.f)(c,this.transformations),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];this.translate(e.map((function(t){return-t})));var n=[this._rotateX(t.gamma),this._rotateY(t.beta),this._rotateZ(t.alpha)],a=n.reduce((function(t,e){return Object(u.f)(t,e)}));return this.transformations=Object(u.f)(a,this.transformations),this.translate(e),this}},{key:"translate",value:function(t){var e=Object(i.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(u.c)([[1,0,0,n],[0,1,0,a],[0,0,1,r],[0,0,0,1]]);return this.transformations=Object(u.f)(c,this.transformations),this}},{key:"perspective",value:function(t,e,n){var a=Object(u.h)(.5*(Math.PI-t)),r=2*e*n/(e-n),c=(e+n)/(e-n),o=Object(u.c)([[a,0,0,0],[0,+c,0,r],[0,0,a,0],[0,-1,0,0]]);return this.transformations=Object(u.f)(o,this.transformations),this}},{key:"view",get:function(){return this.transformations}}]),t}(),M={alpha:Math.PI/4,beta:0,gamma:Math.PI/4},P=function(t){var e=t.df,n=t.width,r=t.height,c=Object(a.useState)(M),o=Object(i.a)(c,2),h=o[0],l=o[1],f=Object(a.useRef)({x:0,y:0}),b=function(t){f.current={x:t.x,y:t.y}},O=function(t){return l({alpha:Object(u.e)(h.alpha-(t.x-f.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.e)(h.gamma+(t.y-f.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(s.c)().on("start",b).on("drag",O).on("end",(function(t){return console.log("end")}));Object(s.g)("svg").call(t),Object(s.h)(".three").sort(j)}));var p=Object(s.f)(s.d).domain([1,-1]),d=(new I).rotate(h).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([300,300,300]);return Object(g.jsxs)("svg",{width:n,height:r,children:[Object(g.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(g.jsx)(w,{df:e,camera:d}),Object(g.jsx)(k,{df:e,camera:d,angles:h}),Object(g.jsx)(x,{df:e,camera:d,colorScale:p})]}),Object(g.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(g.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(g.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},_=function(){var t=Object(a.useState)(null),e=Object(i.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(s.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(f).then(b).then(r)}),[]),n?(console.log(n),Object(g.jsx)("div",{children:Object(g.jsx)(P,{df:n,width:900,height:600})})):"Loading..."};o.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(_,{})}),document.getElementById("root"))}},[[178,1,2]]]);
//# sourceMappingURL=main.1c0259b1.chunk.js.map