(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{176:function(t,e){},178:function(t,e,n){"use strict";n.r(e);var a=n(4),r=n.n(a),i=n(84),c=n.n(i),s=n(7),o=n(2),u=n(182),h=n(181),l=n(14),f=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},p=function(t){var e=Object(l.a)().domain(Object(h.a)(t.columns)).range([-1,1]),n=Object(l.a)().domain(Object(h.a)(t.values.flat())).range([1,-1]),a=Object(l.a)().domain(Object(h.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return a(t)}))}},j=function(t,e){console.log(t,e,t.centroid.y,e.centroid.y);return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},b=n(22),y=n(23),d=n(15),O=function(){function t(e){Object(b.a)(this,t),this.coordinates=e,this.x=e[0],this.y=e[1],this.z=e[2],this.w=1}return Object(y.a)(t,[{key:"_rotateX",value:function(t){var e=this.y,n=this.z;this.y=Object(u.a)(t)*e+Object(u.d)(t)*n,this.z=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"_rotateY",value:function(t){var e=this.x,n=this.z;this.x=Object(u.a)(t)*e-Object(u.d)(t)*n,this.z=Object(u.a)(t)*n+Object(u.d)(t)*e}},{key:"_rotateZ",value:function(t){var e=this.x,n=this.y;this.x=Object(u.a)(t)*e+Object(u.d)(t)*n,this.y=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"scale",value:function(t){return this.x*=t[0],this.y*=t[1],this.z*=t[2],this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.translate(e.map((function(t){return-t}))),this._rotateZ(t.alpha),this._rotateY(t.beta),this._rotateX(t.gamma),this.translate(e),this}},{key:"translate",value:function(t){return this.x+=t[0],this.y+=t[1],this.z+=t[2],this}},{key:"perspective",value:function(t,e,n){var a=this.x,r=this.y,i=this.z,c=Object(u.e)((Math.PI-t)/2),s=(e+n)/(2*e*n),o=2*e*n/(e-n);return this.x=c*a/(o*r),this.y=s-1/(o*r),this.z=c*i/(o*r),this}},{key:"centroid",get:function(){return{x:this.x,y:this.y,z:this.z}}}]),t}(),m=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();Object(b.a)(this,t),this.points=e.map((function(t){return new O(t)})),this.generator=n}return Object(y.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.points=this.points.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.points=this.points.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.points=this.points.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.points.map((function(t){return t.x}))),y:Object(u.b)(this.points.map((function(t){return t.y}))),z:Object(u.b)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=[].concat(Object(d.a)(this.points),[this.points[0]]),e=0,n=0;n<t.length-1;n++){var a=t[n],r=t[n+1];e+=(r.x-a.x)*(r.z+a.z)}return e}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.b)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),g=function(){function t(e){Object(b.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},a=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},r=0;r<e.index.length-1;r++)for(var i=0;i<e.columns.length-1;i++)this.polygons.push(new m(a(r,i)))}return Object(y.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.polygons=this.polygons.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.polygons=this.polygons.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.polygons=this.polygons.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.b)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.b)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(j)}}]),t}(),v=n(1),x=function(t){var e=t.df,n=t.angles,r=t.colorScale,i=new g(e).rotate(n).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){return Object(o.h)(".marks").data(i.paths)})),i.paths.map((function(t,e){return Object(v.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(o.a)(r(t.colorValue)).darker():r(t.colorValue)},e)}))},k=function(t){var e=t.angles,n=e.alpha>Math.PI?-1.075:1.075,r=new m([[n,1,1],[n,1,-1],[n,-1,-1],[n,-1,1]]).rotate(e).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]),i=e.alpha>1.5*Math.PI||e.alpha<.5*Math.PI?-1.075:1.075,c=new m([[1,i,1],[1,i,-1],[-1,i,-1],[-1,i,1]]).rotate(e).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){Object(o.h)(".xWall").data(r),Object(o.h)(".yWall").data(c)})),Object(v.jsxs)("g",{children:[Object(v.jsx)("path",{className:"xWall",d:r.data,opacity:"60%",fill:"grey"}),Object(v.jsx)("path",{className:"yWall",d:c.data,opacity:"60%",fill:"grey"})]})},z=function(t){var e=t.angles,n=new m([[1,1,1.075],[1,-1,1.075],[-1,-1,1.075],[-1,1,1.075]]).rotate(e).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){return Object(o.h)(".floor").data(n)})),Object(v.jsx)("path",{className:"floor",d:n.data,opacity:"60%",fill:"grey"})},I={alpha:7*Math.PI/4,beta:0,gamma:7*Math.PI/4},M=function(t){var e=t.df,n=t.width,r=t.height,i=Object(a.useState)(I),c=Object(s.a)(i,2),h=c[0],l=c[1],f=Object(a.useRef)({x:0,y:0}),p=function(t){f.current={x:t.x,y:t.y}},b=function(t){return l({alpha:Object(u.c)(h.alpha+(t.x-f.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.c)(h.gamma-(t.y-f.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(o.c)().on("start",p).on("drag",b);Object(o.g)("svg").call(t),Object(o.h)(".three").sort(j),console.log(Object(o.h)(".three").sort(j))}));var y=Object(o.f)(o.d).domain([1,-1]);return Object(v.jsxs)("svg",{width:n,height:r,children:[Object(v.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(v.jsx)(z,{angles:h}),Object(v.jsx)(k,{angles:h}),Object(v.jsx)(x,{df:e,angles:h,colorScale:y})]}),Object(v.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(v.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(v.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},w=function(){var t=Object(a.useState)(null),e=Object(s.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(f).then(p).then(r)}),[]),n?(console.log(n),Object(v.jsx)("div",{children:Object(v.jsx)(M,{df:n,width:900,height:600})})):"Loading..."};c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(w,{})}),document.getElementById("root"))}},[[178,1,2]]]);
//# sourceMappingURL=main.8213305e.chunk.js.map