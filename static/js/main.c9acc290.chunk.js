(this["webpackJsonpthe-volatility-surface"]=this["webpackJsonpthe-volatility-surface"]||[]).push([[0],{176:function(t,e){},178:function(t,e,n){"use strict";n.r(e);var a=n(4),r=n.n(a),i=n(84),s=n.n(i),c=n(5),o=n(3),u=n(182),h=n(181),l=n(14),p=function(t){var e=t.columns.slice(1),n=t.columns[0];return{columns:e.map((function(t){return+t})),values:t.map((function(t){return e.map((function(e){return+t[e]}))})),index:t.map((function(t){return+t[n]}))}},f=function(t){var e=Object(l.a)().domain(Object(h.a)(t.columns)).range([-1,1]),n=Object(l.a)().domain(Object(h.a)(t.values.flat())).range([1,-1]),a=Object(l.a)().domain(Object(h.a)(t.index)).range([-1,1]);return{columns:t.columns.map((function(t){return e(t)})),values:t.values.map((function(t){return t.map((function(t){return n(t)}))})),index:t.index.map((function(t){return a(t)})),labels:t}},j=function(t,e){return t.centroid.y<e.centroid.y?1:t.centroid.y>e.centroid.y?-1:0},b=n(22),d=n(23),y=n(15),O=function(){function t(e){Object(b.a)(this,t),this.coordinates=e,this.x=e[0],this.y=e[1],this.z=e[2],this.w=1}return Object(d.a)(t,[{key:"_rotateX",value:function(t){var e=this.y,n=this.z;this.y=Object(u.a)(t)*e+Object(u.d)(t)*n,this.z=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"_rotateY",value:function(t){var e=this.x,n=this.z;this.x=Object(u.a)(t)*e-Object(u.d)(t)*n,this.z=Object(u.a)(t)*n+Object(u.d)(t)*e}},{key:"_rotateZ",value:function(t){var e=this.x,n=this.y;this.x=Object(u.a)(t)*e+Object(u.d)(t)*n,this.y=Object(u.a)(t)*n-Object(u.d)(t)*e}},{key:"scale",value:function(t){return this.x*=t[0],this.y*=t[1],this.z*=t[2],this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.translate(e.map((function(t){return-t}))),this._rotateZ(t.alpha),this._rotateY(t.beta),this._rotateX(t.gamma),this.translate(e),this}},{key:"translate",value:function(t){return this.x+=t[0],this.y+=t[1],this.z+=t[2],this}},{key:"perspective",value:function(t,e,n){var a=this.x,r=this.y,i=this.z,s=Object(u.e)((Math.PI-t)/2),c=(e+n)/(2*e*n),o=2*e*n/(e-n);return this.x=s*a/(o*r),this.y=c-1/(o*r),this.z=s*i/(o*r),this}},{key:"centroid",get:function(){return{x:this.x,y:this.y,z:this.z}}}]),t}(),v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();Object(b.a)(this,t),this.points=e.map((function(t){return new O(t)})),this.generator=n}return Object(d.a)(t,[{key:"scale",value:function(t){return this.points=this.points.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.points=this.points.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.points=this.points.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.points=this.points.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.points.map((function(t){return t.x}))),y:Object(u.b)(this.points.map((function(t){return t.y}))),z:Object(u.b)(this.points.map((function(t){return t.z})))}}},{key:"area",get:function(){for(var t=[].concat(Object(y.a)(this.points),[this.points[0]]),e=0,n=0;n<t.length-1;n++){var a=t[n],r=t[n+1];e+=(r.x-a.x)*(r.z+a.z)}return e}},{key:"data",get:function(){return this.generator(this.points.map((function(t){return[t.x,t.z]})))}},{key:"colorValue",get:function(){return Object(u.b)(this.points.map((function(t){return t.coordinates[2]})))}}]),t}(),m=function(){function t(e){Object(b.a)(this,t),this.df=e,this.polygons=[];for(var n=function(t,n){return[e.columns[n],e.index[t],e.values[t][n]]},a=function(t,e){return[n(t,e),n(t,e+1),n(t+1,e+1),n(t+1,e)]},r=0;r<e.index.length-1;r++)for(var i=0;i<e.columns.length-1;i++)this.polygons.push(new v(a(r,i)))}return Object(d.a)(t,[{key:"scale",value:function(t){return this.polygons=this.polygons.map((function(e){return e.scale(t)})),this}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return this.polygons=this.polygons.map((function(n){return n.rotate(t,e)})),this}},{key:"translate",value:function(t){return this.polygons=this.polygons.map((function(e){return e.translate(t)})),this}},{key:"perspective",value:function(t,e,n){return this.polygons=this.polygons.map((function(a){return a.perspective(t,e,n)})),this}},{key:"centroid",get:function(){return{x:Object(u.b)(this.polygons.map((function(t){return t.centroid.x}))),y:Object(u.b)(this.polygons.map((function(t){return t.centroid.y}))),z:Object(u.b)(this.polygons.map((function(t){return t.centroid.z})))}}},{key:"paths",get:function(){return this.polygons.sort(j)}}]),t}(),x=n(1),g=function(t){var e=t.df,n=t.angles,r=t.colorScale,i=new m(e).rotate(n).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){return Object(o.h)(".marks").data(i.paths)})),i.paths.map((function(t,e){return Object(x.jsx)("path",{className:"three marks",d:t.data,fill:t.area>0?Object(o.a)(r(t.colorValue)).darker():r(t.colorValue)},e)}))},k=function(t){var e=t.angles,n=e.alpha>Math.PI?-1.075:1.075,r=new v([[n,1,1],[n,1,-1],[n,-1,-1],[n,-1,1]]).rotate(e).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]),i=e.alpha>1.5*Math.PI||e.alpha<.5*Math.PI?-1.075:1.075,s=new v([[1,i,1],[1,i,-1],[-1,i,-1],[-1,i,1]]).rotate(e).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);return Object(a.useEffect)((function(){Object(o.h)(".xWall").data(r),Object(o.h)(".yWall").data(s)})),Object(x.jsxs)("g",{children:[Object(x.jsx)("path",{className:"xWall",d:r.data,opacity:"60%",fill:"grey"}),Object(x.jsx)("path",{className:"yWall",d:s.data,opacity:"60%",fill:"grey"})]})},I=n(6),M=function(t){var e,n=t.df,r=t.angles,i=new v([[1,1,1.075],[1,-1,1.075],[-1,-1,1.075],[-1,1,1.075]]).rotate(r).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]),s=[],u=[],h=r.alpha<Math.PI?-1.15:1.15,l=Object(I.a)(n.index.entries());try{for(l.s();!(e=l.n()).done;){var p=Object(c.a)(e.value,2),f=p[0],j=p[1],b=new v([[-1,j,1.075],[1,j,1.075]]).rotate(r).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);s.push(b);var d={text:n.labels.index[f],position:new O([h,j,1.1]).rotate(r).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500])};u.push(d)}}catch(_){l.e(_)}finally{l.f()}var y,m=r.alpha<1.5*Math.PI&&r.alpha>.5*Math.PI?-1.15:1.15,g=Object(I.a)(n.columns.entries());try{for(g.s();!(y=g.n()).done;){var k=Object(c.a)(y.value,2),M=k[0],P=k[1],z=new v([[P,-1,1.075],[P,1,1.075]]).rotate(r).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500]);s.push(z);var w={text:n.labels.columns[M],position:new O([P,m,1.1]).rotate(r).translate([0,-10,0]).perspective(Math.PI/8,1,200).scale([500,500,500])};u.push(w)}}catch(_){g.e(_)}finally{g.f()}return Object(a.useEffect)((function(){return Object(o.h)(".floor").data(i)})),Object(x.jsxs)("g",{children:[Object(x.jsx)("path",{className:"floor",d:i.data,opacity:"60%",fill:"grey"}),s.map((function(t){return Object(x.jsx)("path",{className:"grid",d:t.data,stroke:"lightgrey",strokeWidth:"1"})})),u.map((function(t){var e=t.text,n=t.position;return Object(x.jsx)("text",{x:n.x-12,y:n.z+2,fontSize:11,children:e.toFixed(2)})}))]})},P={alpha:7*Math.PI/4,beta:0,gamma:7*Math.PI/4},z=function(t){var e=t.df,n=t.width,r=t.height,i=Object(a.useState)(P),s=Object(c.a)(i,2),h=s[0],l=s[1],p=Object(a.useRef)({x:0,y:0}),f=function(t){p.current={x:t.x,y:t.y}},b=function(t){return l({alpha:Object(u.c)(h.alpha+(t.x-p.current.x)/300*Math.PI,2*Math.PI),beta:h.beta,gamma:Object(u.c)(h.gamma-(t.y-p.current.y)/300*Math.PI,2*Math.PI)})};Object(a.useEffect)((function(){var t=Object(o.c)().on("start",f).on("drag",b);Object(o.g)("svg").call(t),Object(o.h)(".three").sort(j)}));var d=Object(o.f)(o.d).domain([1,-1]);return Object(x.jsxs)("svg",{width:n,height:r,children:[Object(x.jsxs)("g",{transform:"translate(".concat(n/2,", ").concat(r/2,")"),children:[Object(x.jsx)(M,{df:e,angles:h}),Object(x.jsx)(k,{df:e,angles:h}),Object(x.jsx)(g,{df:e,angles:h,colorScale:d})]}),Object(x.jsxs)("text",{x:10,y:10,children:["Alpha: ",h.alpha]}),Object(x.jsxs)("text",{x:10,y:30,children:["Beta: ",h.beta]}),Object(x.jsxs)("text",{x:10,y:50,children:["Gamma: ",h.gamma]})]})},w=function(){var t=Object(a.useState)(null),e=Object(c.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){return Object(o.b)("https://raw.githubusercontent.com/kmatolcsy/options/master/2021-04-16/implied_vols_parametric_dfw.csv").then(p).then(f).then(r)}),[]),n?Object(x.jsx)("div",{children:Object(x.jsx)(z,{df:n,width:900,height:600})}):"Loading..."};s.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(w,{})}),document.getElementById("root"))}},[[178,1,2]]]);
//# sourceMappingURL=main.c9acc290.chunk.js.map